#WEB浏览器中的JavaScript#
***
##客户端JavaScript##

window对象是所有客户端JavaScript特性和API的主要接入点，表示浏览器的一个窗口或窗体，并且可以用标识符window来引用他。window对象定义了一些属性和方法。

在客户端JavaScript中，window对象也是全局对象。这意味着window对象处于作用域链的顶部，它的属性和方法实际上是全局变量和全局函数。

##HTML里嵌入JavaScript##

在HTML文档里嵌入客户端JavaScript有4种方式：

* 内联 放在``<script>``和``</script>``标签对之间
* 放置在由``<script>``标签的src属性指定的外部文件中
* 放置在HTML事件处理程序中，该事件处理程序由onclick或者onmouseover这样的HTML属性值指定
* 放在一个URL里，这个URL使用特殊的"javascript："协议（阻止链接跳转等默认行为时可能会使用）

后两种很少使用现在

### ``<script>``元素 ###

JavaScript代码可以以内联的形式出现在HTML文件里的``<script>``和``</script>``标签之间


###外部文件中的脚本###

``<script>``标签支持src属性，可以指定包含JavaScript代码文件的URL。JavaScript文件的扩展名通常以.js结尾。包含纯粹的JavaScript代码，没有``<script>``标签，也没有其它HTML标签

##JavaScript程序的执行##

JavaScript程序是由web页面中所包含的所有JavaScript代码（内联脚本，HTML事件处理程序和JavaScript：URL）和通过``<script>``的src属性引用的外部JavaScript代码组成。所有的这些单独的代码共用一个全局window对象，这意味着它们都可以看到同一个Document对象，可以共享相同的全局函数和变量的集合，如果一个脚本定义了一个新的全局变量或者函数，那么这个变量或函数会在脚本执行后对任意JavaScript代码可见。

JavaScript程序执行有两个阶段

* 第一个阶段，载入文档内容并执行``<script>``元素里的代码，脚本通常会按照他们在文档里的出现顺序执行。所有脚本里的JavaScript代码都是从上往下，按照它在条件、循环以及其它控制语句中的出现顺序执行。
* 当文档载入完成并且所有脚本执行完成后，JavaScript执行进入第二阶段。这个阶段是异步的，由事件驱动。在事件驱动阶段，web浏览器调用事件处理程序函数，来响应异步发生的事件。事件驱动阶段里发生的第一个事件就是load事件，指示文档已经完全载入，并可以操作。

##客户端的JavaScript时间线##

1. web浏览器创建document对象，并且开始解析web页面，解析HTML元素和他的文本内容后添加Element对象和Text节点到文档中。在这个阶段document.readystate属性的值是'loading'。
2. 当HTML接下遇到没有async和defer属性的``<script>``元素时，它把这些元素添加到文档中，然后执行行内或者外部脚本。这些脚本会同步执行，并且在脚本下载（如果需要）和执行时解析器会暂停。这样脚本就可以用document.write()来把文本插入到输入流中。解析器恢复时这些文本会成为文档的一部分。同步脚本经常简单定义函数和注册后面使用的注册事件处理程序，但他们可以遍历和操作文档树，因为在塔们执行时已经存在了。这样，同步脚本可以看到它自己的``<script>``元素和它们之前的文档内容。
3. 当解析器遇到了设置async属性的``<script>``元素时，它开始下载脚本文件，并继续解析文档。脚本会在它下载完成后尽快执行，但是解析器没有停下来等它下载。异步脚本禁止使用document.write()方法。它们可以看到自己的``<script>``元素和它之前的所有文档元素，并且可能或者干脆不可能访问其他的文档内容。
4. 当文档完成解析，document.readyState属性变成'interactive'。
5. 所有defer属性的脚本，会按他们在文档里的出现顺序执行。异步脚本可能也会在这个时间执行。延迟脚本能访问完整的文档树，禁止使用document.write()方法
6. 浏览器在document对象上触发DOMContentLoaded事件。这标志着程序执行从同步脚本执行阶段转换到了异步事件驱动阶段。但要注意，这时可能还有异步脚本没有执行完成。
7. 这时，文档已经完全解析完成，但是浏览器可能还在等待其它内容载入，如图片。当所有这些内容完成载入时，并且所有异步脚本完成载入和执行，document.readyState属性改变为'complete'，web浏览器触发window对象上的load事件。
8. 此刻起，会调用异步事件，以异步响应用户输入事件，网络事件，计时器过期等。

这是理想的时间线，但所有浏览器都没有支持它的全部细节。所有浏览器普遍都支持load事件，都会触发，它是决定文档完全载入冰可以操作最通用的技术。DOMcontentLoaded事件在load事件之前触发，当前所有浏览器都支持这个事件，除了IE。
